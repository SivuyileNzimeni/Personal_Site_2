{"title":"2023 South African Macroeconomic Database","markdown":{"yaml":{"title":"2023 South African Macroeconomic Database","image":"Codera_Analytics_Logo.jpg","image-alt":"The image contains a logo of Codera Analytics","lang":"en-GB","date":"June 21,2023","author":"Sivuyile Nzimeni","description":"This post walks-through accessing South African Macroeconomic Data in South Africa through the SAMADB package","categories":["api","data cleaning","visualisation"],"fig-dpi":300,"fig-align":"center","fig-cap-location":"top","code-copy":true,"code-line-numbers":true,"page-layout":"article","cap-location":"margin","number-sections":true,"toc":true,"lot":true,"lof":true,"toc-title":"CONTENTS","execute":{"echo":true,"warning":false}},"headingText":"INTRODUCTION","containsRefs":false,"markdown":"\n\n\nCRAN Task Views contain important updates on packages, databases and other developments in the R community. Among the packages listed in the [Time Series](https://cran.r-project.org/web/views/TimeSeries.html) task view is the [SAMADB](https://cran.r-project.org/web/packages/samadb/index.html) R packages maintained by the Department of Economics at Stellenbosch University. The packages relies on [EconData](https://www.econdata.co.za/) for weekly updates on South African macroeconomic data from Statistics South Africa(StatsSA) and the South African Reserve Bank (SARB).\n\nStatsSA and SARB are among a few governmental organisations that regularly publish data. Data collection can be a bit combersome since the data are often published in xlsx, csv or an exotic formats. In addition, the data often has multiple versions, to include, more recent data.Effectively, the package streamlines the data access via standardising,versioning and storing the data from the above mentioned institutions.\n\n```{r Libraries}\n#| warning: false\n#| message: false\n\nlapply(c(\"dplyr\",\"stringr\",\"janitor\",\"samadb\",\n         \"reactable\",\"reactablefmtr\",\"ggplot2\",\n         \"ggthemes\"),\n       require,character.only = TRUE) |> \n  suppressMessages() |> \n  suppressWarnings()\nextrafont::loadfonts(device = \"win\")\ntheme_set(theme_minimal())\n```\n\n## AVAILABLE DATASETS\n\nThe table below provides an interactive table of all the datasets available from the package. The table is derived from the `sm_datasets()` function, which returns a `data.table` object containing important such as the dataset id, the full name of the data, frequency of publication along with the number of records and series available.\n\n```{r Available_Data}\n#| fig-cap: \"SAMADB_Datasets\"\nsm_datasets() |> \n  reactable(theme = espn(),\n            defaultColDef = colDef(),\n            searchable = TRUE,\n            filterable = TRUE)\n```\n\nIn our walk-through, we rely on the Motor Trade sales from Statistics South Africa. The data ranges from 1998-01-01 - 2023-02-01, collected monthly. Below, we illustrade how to a straight-forward way of collecting the data from the EconData database. We specify the `dsid` listed in table above. Thereafter, replace variable names with their labels.\n\n::: {.callout-note title=\"Labelled Variables\"}\nMany statistical analysis packages (SPSS,SAS and Stata etc.) utilise labels in their data analysis. This affords researchers the opportunity to encapsulate assign text labels with the associated values. In R it possible to make use of `labelled vectors` or `factors` without losing meaningful information.\n:::\n\n```{r Motor_Vehicle_Trade}\nMotor_Trade <- sm_data(dsid=\"MOTOR_TRADE\")|>data.frame()\n\n\nVariable_Labels <- labelled::var_label(Motor_Trade)\n\nNULL -> names(Variable_Labels)\nVariable_Labels <- unlist(Variable_Labels)\n\nVariable_Labels <- c(\"Date\",Variable_Labels)\n\nnames(Motor_Trade) <- Variable_Labels\n\nMotor_Trade <- Motor_Trade |> \n  clean_names() |> \n  labelled::remove_var_label()\n```\n\nWith the data in hand, we can explore the dataset further, such as obtaining an overview of completeness(or lack thereof) of the dataset. Here, we rely on the `skimr` package to fulfil this task.\n\n```{r Missing_Data}\n#| cap-location: top\n#| fig-cap: 2023 Motor Trade Overview\nMotor_Trade |>\n  skimr::skim()\n```\n\nThe dataset contains some missing data from 1998-01-01 to 2005-08-01. Fortunately, there is a pattern in the missing values. Data was not collect for variables listed. From 2005-09-01 onward, StatsSA started collecting more detailed information about motor trade sector.\n\n```{r Data_Cleaning}\nMotor_Trade <- Motor_Trade[!is.na(Motor_Trade$income_from_fuel_sales_real_rand_million),] |> \n#Timeseries Features\n    mutate(quarter = lubridate::quarter(date,type= \"year.quarter\"),\n           month = lubridate::month(date,label=TRUE,abbr=FALSE),\n           year = lubridate::year(date))\n\nrow.names(Motor_Trade) <- NULL\n```\n\n```{r Data_Visualisation}\n#| include: true\n#| dpi: 320\n#| fig-cap-location: top\n#| fig-cap: 2005 - 2023 Motor Trade Data\n\nMotor_Trade |> \n  ggplot(aes(date,income_from_fuel_sales_real_rand_millions))+\n  geom_line()+\n  labs(title = \"2005 - 2023 Motor Trade Data\",\n       subtitle = \"Real Income From Fuel Sales Rand Millions\",\n       y= \"fuel sales (R Millions)\",\n       x = \"year\",\n       caption = \"Data Source: Krantz,S.2023.'South Africa Macroeconomic Database API'.R package version 0.2.6.\\nAvailable from: https://CRAN.R-Project.org/package=samadb'\")+\n  theme(text = element_text(family = \"IBM Plex Sans\"),\n    plot.title = element_text(face = \"bold\",hjust =0.5),\n        plot.subtitle = element_text(face = \"italic\",hjust=0.5),\n        plot.caption = element_text(size =7))\n\n```\n\n```{r Forecast}\nlibrary(forecast)\n\nFuel_Sales_Ts <- ts(Motor_Trade[,c(\"income_from_fuel_sales_real_rand_millions\")],\n   start = c(2005,09,01),end = c(2023,02,01),frequency = 12)\n\nggAcf(Fuel_Sales_Ts,ci=0.95,lag.max=20)\n\nautoplot(Fuel_Sales_Ts)+\n  autolayer(meanf(Fuel_Sales_Ts,lambda = 0,h=12),series = \"Mean\", PI=F)+\n  autolayer(rwf(Fuel_Sales_Ts,h=12,lambda =0),series= \"Naive\",PI=F)+\n  autolayer(rwf(Fuel_Sales_Ts,h=12,lambda = 0,drift=T,biasadj = T),series=\"Drift\",PI=F)+\n  ggtitle(label = \"2005 - 2024: Real Income From Fuel Sales\",\n        subtitle = \"(R) millions including forecast for 2024\")+\n  labs(caption = \"Data Source: Krantz,S.2023.'South Africa Macroeconomic Database API'.R package version 0.2.6.\\nAvailable from: https://CRAN.R-Project.org/package=samadb'\")+\n  theme(text = element_text(\"IBM Plex Sans\"),\n        plot.title = element_text(face = \"bold\",hjust=0.5),\n        plot.subtitle = element_text(face = \"italic\",hjust=0.5),\n        plot.caption = element_text(face = \"italic\",hjust=-0.01,size =6))\n```\n","srcMarkdownNoYaml":"\n\n# INTRODUCTION\n\nCRAN Task Views contain important updates on packages, databases and other developments in the R community. Among the packages listed in the [Time Series](https://cran.r-project.org/web/views/TimeSeries.html) task view is the [SAMADB](https://cran.r-project.org/web/packages/samadb/index.html) R packages maintained by the Department of Economics at Stellenbosch University. The packages relies on [EconData](https://www.econdata.co.za/) for weekly updates on South African macroeconomic data from Statistics South Africa(StatsSA) and the South African Reserve Bank (SARB).\n\nStatsSA and SARB are among a few governmental organisations that regularly publish data. Data collection can be a bit combersome since the data are often published in xlsx, csv or an exotic formats. In addition, the data often has multiple versions, to include, more recent data.Effectively, the package streamlines the data access via standardising,versioning and storing the data from the above mentioned institutions.\n\n```{r Libraries}\n#| warning: false\n#| message: false\n\nlapply(c(\"dplyr\",\"stringr\",\"janitor\",\"samadb\",\n         \"reactable\",\"reactablefmtr\",\"ggplot2\",\n         \"ggthemes\"),\n       require,character.only = TRUE) |> \n  suppressMessages() |> \n  suppressWarnings()\nextrafont::loadfonts(device = \"win\")\ntheme_set(theme_minimal())\n```\n\n## AVAILABLE DATASETS\n\nThe table below provides an interactive table of all the datasets available from the package. The table is derived from the `sm_datasets()` function, which returns a `data.table` object containing important such as the dataset id, the full name of the data, frequency of publication along with the number of records and series available.\n\n```{r Available_Data}\n#| fig-cap: \"SAMADB_Datasets\"\nsm_datasets() |> \n  reactable(theme = espn(),\n            defaultColDef = colDef(),\n            searchable = TRUE,\n            filterable = TRUE)\n```\n\nIn our walk-through, we rely on the Motor Trade sales from Statistics South Africa. The data ranges from 1998-01-01 - 2023-02-01, collected monthly. Below, we illustrade how to a straight-forward way of collecting the data from the EconData database. We specify the `dsid` listed in table above. Thereafter, replace variable names with their labels.\n\n::: {.callout-note title=\"Labelled Variables\"}\nMany statistical analysis packages (SPSS,SAS and Stata etc.) utilise labels in their data analysis. This affords researchers the opportunity to encapsulate assign text labels with the associated values. In R it possible to make use of `labelled vectors` or `factors` without losing meaningful information.\n:::\n\n```{r Motor_Vehicle_Trade}\nMotor_Trade <- sm_data(dsid=\"MOTOR_TRADE\")|>data.frame()\n\n\nVariable_Labels <- labelled::var_label(Motor_Trade)\n\nNULL -> names(Variable_Labels)\nVariable_Labels <- unlist(Variable_Labels)\n\nVariable_Labels <- c(\"Date\",Variable_Labels)\n\nnames(Motor_Trade) <- Variable_Labels\n\nMotor_Trade <- Motor_Trade |> \n  clean_names() |> \n  labelled::remove_var_label()\n```\n\nWith the data in hand, we can explore the dataset further, such as obtaining an overview of completeness(or lack thereof) of the dataset. Here, we rely on the `skimr` package to fulfil this task.\n\n```{r Missing_Data}\n#| cap-location: top\n#| fig-cap: 2023 Motor Trade Overview\nMotor_Trade |>\n  skimr::skim()\n```\n\nThe dataset contains some missing data from 1998-01-01 to 2005-08-01. Fortunately, there is a pattern in the missing values. Data was not collect for variables listed. From 2005-09-01 onward, StatsSA started collecting more detailed information about motor trade sector.\n\n```{r Data_Cleaning}\nMotor_Trade <- Motor_Trade[!is.na(Motor_Trade$income_from_fuel_sales_real_rand_million),] |> \n#Timeseries Features\n    mutate(quarter = lubridate::quarter(date,type= \"year.quarter\"),\n           month = lubridate::month(date,label=TRUE,abbr=FALSE),\n           year = lubridate::year(date))\n\nrow.names(Motor_Trade) <- NULL\n```\n\n```{r Data_Visualisation}\n#| include: true\n#| dpi: 320\n#| fig-cap-location: top\n#| fig-cap: 2005 - 2023 Motor Trade Data\n\nMotor_Trade |> \n  ggplot(aes(date,income_from_fuel_sales_real_rand_millions))+\n  geom_line()+\n  labs(title = \"2005 - 2023 Motor Trade Data\",\n       subtitle = \"Real Income From Fuel Sales Rand Millions\",\n       y= \"fuel sales (R Millions)\",\n       x = \"year\",\n       caption = \"Data Source: Krantz,S.2023.'South Africa Macroeconomic Database API'.R package version 0.2.6.\\nAvailable from: https://CRAN.R-Project.org/package=samadb'\")+\n  theme(text = element_text(family = \"IBM Plex Sans\"),\n    plot.title = element_text(face = \"bold\",hjust =0.5),\n        plot.subtitle = element_text(face = \"italic\",hjust=0.5),\n        plot.caption = element_text(size =7))\n\n```\n\n```{r Forecast}\nlibrary(forecast)\n\nFuel_Sales_Ts <- ts(Motor_Trade[,c(\"income_from_fuel_sales_real_rand_millions\")],\n   start = c(2005,09,01),end = c(2023,02,01),frequency = 12)\n\nggAcf(Fuel_Sales_Ts,ci=0.95,lag.max=20)\n\nautoplot(Fuel_Sales_Ts)+\n  autolayer(meanf(Fuel_Sales_Ts,lambda = 0,h=12),series = \"Mean\", PI=F)+\n  autolayer(rwf(Fuel_Sales_Ts,h=12,lambda =0),series= \"Naive\",PI=F)+\n  autolayer(rwf(Fuel_Sales_Ts,h=12,lambda = 0,drift=T,biasadj = T),series=\"Drift\",PI=F)+\n  ggtitle(label = \"2005 - 2024: Real Income From Fuel Sales\",\n        subtitle = \"(R) millions including forecast for 2024\")+\n  labs(caption = \"Data Source: Krantz,S.2023.'South Africa Macroeconomic Database API'.R package version 0.2.6.\\nAvailable from: https://CRAN.R-Project.org/package=samadb'\")+\n  theme(text = element_text(\"IBM Plex Sans\"),\n        plot.title = element_text(face = \"bold\",hjust=0.5),\n        plot.subtitle = element_text(face = \"italic\",hjust=0.5),\n        plot.caption = element_text(face = \"italic\",hjust=-0.01,size =6))\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"wrap","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"output-file":"Index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en-GB","fig-responsive":true,"quarto-version":"1.4.549","editor":"visual","code-copy":true,"code-summary":"see code","theme":{"light":"materia","dark":"darkly"},"title":"2023 South African Macroeconomic Database","image":"Codera_Analytics_Logo.jpg","image-alt":"The image contains a logo of Codera Analytics","date":"June 21,2023","author":"Sivuyile Nzimeni","description":"This post walks-through accessing South African Macroeconomic Data in South Africa through the SAMADB package","categories":["api","data cleaning","visualisation"],"fig-cap-location":"top","page-layout":"article","cap-location":"margin","lot":true,"lof":true,"toc-title":"CONTENTS"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}